
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<div class="container">

  <!-- Page header start -->


  <!-- Page header end -->
<body>
  <!-- Content wrapper start -->
  <div class="content-wrapper">

    <!-- Row start -->
    <div class="row gutters">

      <div >

        <div class="card m-0">

          <!-- Row start -->
          <div class="row no-gutters">
            <div class="col-xl-4 col-lg-4 col-md-4 col-sm-3 col-3">
              <div class="users-container">
                <div class="chat-search-box">

                  </div>
                </div>

              </div>
            </div>
            <div class="amal" >

              <div class="chat-container" *ngFor="let aa of this.userservice.map.get(idpersonnel)?.messages">
                <ul class="chat-box chatContainerScroll">
                  <li class="chat-right"  *ngIf="aa.sender === currentuser.cin">
                    <div class="chat-avatar">
                      <img src="https://www.bootdey.com/img/Content/avatar/avatar3.png" alt="Retail Admin">
                      <div class="chat-name">{{aa.username}}</div>
                      <div class="chat-text" *ngIf="aa.text!= null && aa.text.startsWith('$IMG$')">
                        <img [src]="sanitizer.bypassSecurityTrustResourceUrl(aa.text.substr(5))"/>
                      </div>
                      <div class="chat-text" *ngIf="!(aa.text!= null && aa.text.startsWith('$IMG$'))">{{aa.text}}</div>
                    </div>


                  </li>
                  <li class="chat-left"  *ngIf="aa.sender !== currentuser.cin">
                    <div class="chat-avatar">

                    <div class="chat-avatar">
                      <img src="https://www.bootdey.com/img/Content/avatar/avatar3.png" alt="Retail Admin">
                      <div class="chat-name">{{aa.username}}</div>
                      <div class="chat-text" *ngIf="aa.text!= null && aa.text.startsWith('$IMG$')">
                        <img [src]="sanitizer.bypassSecurityTrustResourceUrl(aa.text.substr(5))"/>
                      </div>
                      <div class="chat-text" *ngIf="!(aa.text!= null && aa.text.startsWith('$IMG$'))">{{aa.text}}</div>
                    </div>
                    </div>
                  </li>




                </ul>

              </div>
              <div class="chat-container" *ngFor="let message of Chatservice.messages" >
<div> <td> <p > {{ message | json }}</p></td></div>



                <ul class="chat-box chatContainerScroll">
                  <li class="chat-right" *ngIf="message.sender === currentuser.cin " >
                    <div class="chat-avatar">
                      <img src="https://www.bootdey.com/img/Content/avatar/avatar3.png" alt="Retail Admin">
                      <div class="chat-name">{{message.username}}</div>
                      <div class="chat-text" *ngIf="message.text.startsWith('$IMG$')">
                        <img [src]="sanitizer.bypassSecurityTrustResourceUrl(message.text.substr(5))"/>
                      </div>
                      <div class="chat-text" *ngIf="!message.text.startsWith('$IMG$')">{{message.text}}</div>
                    </div>


                  </li>
                  <li class="chat-left"  *ngIf="message.sender !== currentuser.cin">
                    <div class="chat-avatar">

                      <div class="chat-avatar">
                        <img src="https://www.bootdey.com/img/Content/avatar/avatar3.png" alt="Retail Admin">
                        <div class="chat-name">{{message.username}}</div>
                        <div class="chat-text"   *ngIf="message.text.startsWith('$IMG$')">
                          <img  [src]="sanitizer.bypassSecurityTrustResourceUrl(message.text.substr(5))"/>
                        </div>
                        <div class="chat-text" *ngIf="!message.text.startsWith('$IMG$')">{{message.text}}</div>
                      </div>
                    </div>
                  </li>




                </ul>


            </div>
          </div>
          <!-- Row end -->
        </div>

      </div>

    </div>
    <!-- Row end -->


    <div class="input-group input-group-outline d-flex" style="background-color: white">

      <input type="file" class="file-upload" name="image"    (change)="onFileSelcted($event)">
      <input  name="body" [(ngModel)]="messages" type="text" class="form-control form-control-lg">
      <button   (click)="sendMessage($event, avatar)"  class="btn bg mb-0" >
        <i class="material-icons">send</i>
      </button>
    </div>
    </div>
</body>
  </div>
  <!-- Content wrapper end -->








